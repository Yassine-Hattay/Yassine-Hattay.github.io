<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESP 12 Tracker: C:/msys32/home/hatta/esp/tracker/components/NEO_6M_driver/NEO_6M.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ESP 12 Tracker<span id="projectnumber">&#160;1.0.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_n_e_o__6_m_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">NEO_6M.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>NEO-6M GPS driver for ESP12/ESP8266.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_n_e_o__6_m_8h_source.html">NEO_6M.h</a>&quot;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;driver/uart.h&quot;</code><br />
<code>#include &quot;driver/gpio.h&quot;</code><br />
<code>#include &quot;esp_sleep.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for NEO_6M.c:</div>
<div class="dyncontent">
<div class="center"><img src="_n_e_o__6_m_8c__incl.png" border="0" usemap="#a_c_1_2msys32_2home_2hatta_2esp_2tracker_2components_2_n_e_o__6_m__driver_2_n_e_o__6_m_8c" alt=""/></div>
<map name="a_c_1_2msys32_2home_2hatta_2esp_2tracker_2components_2_n_e_o__6_m__driver_2_n_e_o__6_m_8c" id="a_c_1_2msys32_2home_2hatta_2esp_2tracker_2components_2_n_e_o__6_m__driver_2_n_e_o__6_m_8c">
<area shape="rect" title="NEO&#45;6M GPS driver for ESP12/ESP8266." alt="" coords="1197,5,1384,64"/>
<area shape="rect" href="_n_e_o__6_m_8h.html" title="NEO&#45;6M GPS driver for ESP12/ESP8266." alt="" coords="836,112,922,139"/>
<area shape="poly" title=" " alt="" coords="1197,59,938,114,937,109,1196,53"/>
<area shape="rect" title=" " alt="" coords="1194,427,1337,453"/>
<area shape="poly" title=" " alt="" coords="1300,64,1312,129,1319,207,1319,292,1315,326,1306,359,1283,414,1278,412,1301,357,1310,325,1314,292,1314,207,1307,129,1295,65"/>
<area shape="rect" title=" " alt="" coords="1065,427,1170,453"/>
<area shape="poly" title=" " alt="" coords="1281,65,1131,414,1126,412,1276,63"/>
<area shape="rect" title=" " alt="" coords="108,277,199,304"/>
<area shape="poly" title=" " alt="" coords="1197,49,1048,68,854,97,639,137,425,189,300,231,197,273,195,268,298,226,423,184,638,132,853,92,1047,62,1197,43"/>
<area shape="rect" title=" " alt="" coords="1354,112,1446,139"/>
<area shape="poly" title=" " alt="" coords="1328,62,1374,100,1371,104,1324,66"/>
<area shape="rect" title=" " alt="" coords="1470,112,1562,139"/>
<area shape="poly" title=" " alt="" coords="1365,62,1471,104,1469,108,1363,67"/>
<area shape="rect" href="my__print_8h.html" title=" " alt="" coords="767,352,924,379"/>
<area shape="poly" title=" " alt="" coords="846,142,812,160,797,173,785,188,769,218,761,244,763,271,775,303,790,324,810,341,806,345,786,328,770,305,758,272,756,244,764,216,781,185,794,169,809,156,843,137"/>
<area shape="poly" title=" " alt="" coords="923,135,980,154,1039,184,1108,241,1169,304,1218,365,1252,413,1247,416,1213,368,1165,308,1104,245,1036,189,978,159,922,140"/>
<area shape="rect" title=" " alt="" coords="917,427,1040,453"/>
<area shape="poly" title=" " alt="" coords="916,137,950,156,965,169,977,185,990,214,998,245,1003,308,998,366,989,412,984,411,993,365,998,308,993,246,985,216,973,188,961,173,947,160,914,141"/>
<area shape="poly" title=" " alt="" coords="922,137,964,156,1003,185,1026,212,1047,241,1079,304,1101,364,1114,411,1109,413,1096,366,1074,306,1042,244,1022,215,1000,189,962,160,920,142"/>
<area shape="rect" title=" " alt="" coords="5,427,70,453"/>
<area shape="poly" title=" " alt="" coords="835,133,676,150,458,181,346,201,244,224,158,250,98,280,76,295,61,310,50,328,40,353,35,383,36,412,30,412,29,382,35,351,45,326,57,307,72,291,95,275,157,245,243,219,345,196,457,176,675,145,835,128"/>
<area shape="rect" href="web_8h.html" title="this file contains the header for web server functionality" alt="" coords="437,277,534,304"/>
<area shape="poly" title=" " alt="" coords="847,142,728,189,529,273,527,268,726,184,845,137"/>
<area shape="poly" title=" " alt="" coords="836,139,214,278,213,273,835,134"/>
<area shape="rect" href="sim800_l__driver_8h.html" title="SIM800L driver configuration for ESP12/ESP8266." alt="" coords="795,187,962,229"/>
<area shape="poly" title=" " alt="" coords="882,139,882,171,876,171,876,139"/>
<area shape="rect" href="my__config_8h_source.html" title=" " alt="" coords="725,427,894,453"/>
<area shape="poly" title=" " alt="" coords="842,380,825,414,820,411,837,378"/>
<area shape="poly" title=" " alt="" coords="920,377,1179,421,1178,426,919,382"/>
<area shape="poly" title=" " alt="" coords="870,377,944,417,941,421,867,382"/>
<area shape="poly" title=" " alt="" coords="894,377,1056,420,1054,425,892,382"/>
<area shape="rect" title=" " alt="" coords="184,427,310,453"/>
<area shape="poly" title=" " alt="" coords="767,377,571,399,325,429,324,424,570,393,766,372"/>
<area shape="rect" title=" " alt="" coords="335,427,423,453"/>
<area shape="poly" title=" " alt="" coords="767,379,619,400,439,429,438,424,618,395,766,374"/>
<area shape="rect" title=" " alt="" coords="447,427,524,453"/>
<area shape="poly" title=" " alt="" coords="776,382,540,429,539,423,775,377"/>
<area shape="rect" title=" " alt="" coords="549,427,609,453"/>
<area shape="poly" title=" " alt="" coords="798,382,625,428,623,423,796,377"/>
<area shape="poly" title=" " alt="" coords="766,376,86,437,85,432,766,371"/>
<area shape="rect" title=" " alt="" coords="633,427,701,453"/>
<area shape="poly" title=" " alt="" coords="815,382,713,423,711,418,813,377"/>
<area shape="poly" title=" " alt="" coords="535,299,769,346,767,351,534,304"/>
<area shape="poly" title=" " alt="" coords="451,307,403,327,352,354,308,386,272,418,268,414,305,382,349,350,401,322,449,302"/>
<area shape="poly" title=" " alt="" coords="438,305,397,323,379,336,365,353,360,367,359,382,368,412,362,414,354,383,355,366,361,351,376,333,395,318,436,300"/>
<area shape="poly" title=" " alt="" coords="440,307,404,325,388,338,376,353,372,364,372,373,384,391,406,407,433,420,431,424,403,411,380,395,367,375,367,363,371,351,384,334,401,321,437,302"/>
<area shape="poly" title=" " alt="" coords="535,296,634,316,678,331,695,340,706,350,712,365,706,380,694,392,674,404,624,426,622,421,671,400,690,388,702,377,707,365,702,354,692,345,676,336,632,321,534,301"/>
<area shape="poly" title=" " alt="" coords="437,297,351,303,249,313,154,330,116,341,90,354,76,366,64,381,48,413,44,411,60,378,72,363,87,350,114,336,153,325,248,308,351,297,437,292"/>
<area shape="rect" title=" " alt="" coords="386,352,471,379"/>
<area shape="poly" title=" " alt="" coords="478,306,450,341,445,338,473,303"/>
<area shape="rect" title=" " alt="" coords="495,352,588,379"/>
<area shape="poly" title=" " alt="" coords="497,303,525,338,521,341,493,306"/>
<area shape="rect" title=" " alt="" coords="612,352,692,379"/>
<area shape="poly" title=" " alt="" coords="516,302,610,343,608,348,513,307"/>
<area shape="rect" title=" " alt="" coords="100,352,210,379"/>
<area shape="poly" title=" " alt="" coords="437,305,226,351,225,346,436,300"/>
<area shape="poly" title=" " alt="" coords="887,229,892,265,888,305,869,341,864,338,883,303,887,265,882,230"/>
<area shape="poly" title=" " alt="" coords="915,228,1233,416,1230,421,912,232"/>
<area shape="poly" title=" " alt="" coords="890,229,970,412,965,414,885,231"/>
<area shape="poly" title=" " alt="" coords="902,228,1096,414,1092,418,898,232"/>
<area shape="poly" title=" " alt="" coords="795,223,624,248,426,280,239,309,124,332,82,343,61,354,51,366,45,381,40,411,34,411,40,379,47,364,57,350,81,338,122,327,238,304,425,275,624,243,794,218"/>
<area shape="poly" title=" " alt="" coords="795,229,549,279,548,274,794,224"/>
<area shape="poly" title=" " alt="" coords="795,218,536,242,218,280,215,280,214,275,217,275,536,236,794,213"/>
<area shape="rect" title=" " alt="" coords="784,277,873,304"/>
<area shape="poly" title=" " alt="" coords="868,231,846,266,842,263,864,229"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afa212fc008a24b9f857753a544f750ca" id="r_afa212fc008a24b9f857753a544f750ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afa212fc008a24b9f857753a544f750ca">gps_task</a> (void *arg)</td></tr>
<tr class="memdesc:afa212fc008a24b9f857753a544f750ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPS task to read NMEA sentences from the GPS module and extract coordinates.  <br /></td></tr>
<tr class="separator:afa212fc008a24b9f857753a544f750ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad39b81379d3cbfff0e21a2b9f850e28e" id="r_ad39b81379d3cbfff0e21a2b9f850e28e"><td class="memItemLeft" align="right" valign="top"><a id="ad39b81379d3cbfff0e21a2b9f850e28e" name="ad39b81379d3cbfff0e21a2b9f850e28e"></a>
volatile double&#160;</td><td class="memItemRight" valign="bottom"><b>g_latitude</b> = 0.0</td></tr>
<tr class="separator:ad39b81379d3cbfff0e21a2b9f850e28e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97cdfe1ee5995737801580e6256a7623" id="r_a97cdfe1ee5995737801580e6256a7623"><td class="memItemLeft" align="right" valign="top"><a id="a97cdfe1ee5995737801580e6256a7623" name="a97cdfe1ee5995737801580e6256a7623"></a>
volatile double&#160;</td><td class="memItemRight" valign="bottom"><b>g_longitude</b> = 0.0</td></tr>
<tr class="separator:a97cdfe1ee5995737801580e6256a7623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cee915d5a5c06ab9fde2b935c2e0961" id="r_a9cee915d5a5c06ab9fde2b935c2e0961"><td class="memItemLeft" align="right" valign="top"><a id="a9cee915d5a5c06ab9fde2b935c2e0961" name="a9cee915d5a5c06ab9fde2b935c2e0961"></a>
volatile int&#160;</td><td class="memItemRight" valign="bottom"><b>g_new_fix</b> = 0</td></tr>
<tr class="separator:a9cee915d5a5c06ab9fde2b935c2e0961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03d40eb822cca2f31c055689d233e101" id="r_a03d40eb822cca2f31c055689d233e101"><td class="memItemLeft" align="right" valign="top"><a id="a03d40eb822cca2f31c055689d233e101" name="a03d40eb822cca2f31c055689d233e101"></a>
char&#160;</td><td class="memItemRight" valign="bottom"><b>smsMessage</b> [64] = { 0 }</td></tr>
<tr class="separator:a03d40eb822cca2f31c055689d233e101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80b49238f3f4df1fddd6042ad36b8e56" id="r_a80b49238f3f4df1fddd6042ad36b8e56"><td class="memItemLeft" align="right" valign="top"><a id="a80b49238f3f4df1fddd6042ad36b8e56" name="a80b49238f3f4df1fddd6042ad36b8e56"></a>
TaskHandle_t&#160;</td><td class="memItemRight" valign="bottom"><b>gps_task_handle</b> = NULL</td></tr>
<tr class="separator:a80b49238f3f4df1fddd6042ad36b8e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>NEO-6M GPS driver for ESP12/ESP8266. </p>
<dl class="section author"><dt>Author</dt><dd>yassine hattay </dd></dl>
<p>This module provides functionality to interact with the NEO-6M GPS module:</p><ul>
<li>Parse NMEA sentences (GPRMC) to extract latitude and longitude.</li>
<li>Prepare SMS message with current coordinates for SIM800L transmission.</li>
<li>Monitor GPS fix and trigger deep sleep if no fix is obtained within timeout.</li>
<li>Start SIM800L task automatically once a valid fix is acquired.</li>
</ul>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2025-09-09 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="afa212fc008a24b9f857753a544f750ca" name="afa212fc008a24b9f857753a544f750ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa212fc008a24b9f857753a544f750ca">&#9670;&#160;</a></span>gps_task()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gps_task </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>arg</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPS task to read NMEA sentences from the GPS module and extract coordinates. </p>
<p>This FreeRTOS task continuously reads data from the GPS UART, buffers complete lines, and checks for valid $GPRMC sentences. If a valid fix is obtained, it updates global latitude and longitude, prepares the SMS message, and starts the SIM800 task. If no fix is found within GPS_TIMEOUT_SEC, the ESP8266 enters deep sleep for GPS_RETRY_SLEEP_SEC.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>Task argument (unused). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_n_e_o__6_m_8c_afa212fc008a24b9f857753a544f750ca_icgraph.png" border="0" usemap="#a_n_e_o__6_m_8c_afa212fc008a24b9f857753a544f750ca_icgraph" alt=""/></div>
<map name="a_n_e_o__6_m_8c_afa212fc008a24b9f857753a544f750ca_icgraph" id="a_n_e_o__6_m_8c_afa212fc008a24b9f857753a544f750ca_icgraph">
<area shape="rect" title="GPS task to read NMEA sentences from the GPS module and extract coordinates." alt="" coords="131,5,205,32"/>
<area shape="rect" href="main_8c.html#a630544a7f0a2cc40d8a7fefab7e2fe70" title="Main application entry point for ESP8266." alt="" coords="5,5,83,32"/>
<area shape="poly" title=" " alt="" coords="115,21,83,21,83,16,115,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_409f97388efe006bc3438b95e9edef48.html">components</a></li><li class="navelem"><a class="el" href="dir_8e17ef024e8291f6b69aa369309de2b3.html">NEO_6M_driver</a></li><li class="navelem"><a class="el" href="_n_e_o__6_m_8c.html">NEO_6M.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
